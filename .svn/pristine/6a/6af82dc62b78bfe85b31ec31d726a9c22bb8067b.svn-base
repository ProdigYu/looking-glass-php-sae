<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/**
 * Collect Class
 *
 * @package		LookingGlassSAE
 * @subpackage	Libraries
 * @category	Controller
 * @author		WDLTH
 * @link		http://www.wdlth.com/
 */

require (APPPATH . 'libraries/Wordlist.php');

class Collect extends CI_Controller {

	function __construct() {
		parent::__construct();
	}
	
	public function index()
	{
		exit('403 Forbidden.');
	}
	
	public function abovenet()
	{
		$this->load->library('Iplist');
		$ip = $this->iplist->alidns();
		
		$this->load->library('Wordlist');
		$url = $this->wordlist->abovenet("url", NULL);
		$ref = $this->wordlist->abovenet("ref", NULL);
		$post = $this->wordlist->abovenet("post", $ip);
		
		$this->load->library('Pinglib');
		$result = $this->pinglib->pre_code($url, $ref, $post);
		if($result != FALSE && $result != "")
		{
			echo $result;
		}else{
			log_message('warning', "Cannot receive data of ping from abovenet.");
			die("Error.");
		}
		
	}
	
}