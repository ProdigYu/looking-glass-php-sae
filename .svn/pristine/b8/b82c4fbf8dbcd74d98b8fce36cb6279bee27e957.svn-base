<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/**
 * Parselib Class
 *
 * @package		LookingGlassSAE
 * @subpackage	Libraries
 * @category	Library
 * @author		WDLTH
 * @link		http://www.wdlth.com/
 */

class Parselib {
	
	public function parseping($data)
	{
		$resultarr = array(); 
				
		$arr = explode("\n",$data);
		$arr = array_filter($arr);
		$arr = array_values($arr);
		
		preg_match("/([0-9]+)% packet loss/i", $arr[count($arr) - 2], $lossmatches);
		preg_match("/([0-9]+\.[0-9]+)\/([0-9]+\.[0-9]+)\/([0-9]+\.[0-9]+)\/([0-9]+\.[0-9]+)\ ms/i", $arr[count($arr) - 1], $delaymatches);
		$resultarr["min"] = floor($delaymatches[1]);
		$resultarr["avg"] = floor($delaymatches[2]);
		$resultarr["max"] = floor($delaymatches[3]);
		$resultarr["loss"] = $lossmatches[1];
		
		return $resultarr;
	}
	
	public function parselevel3($data)
	{
		$resultarr = array();
	
		$arr = explode("<br>",$data);
		$arr = array_filter($arr);
		$arr = array_values($arr);
	
		preg_match("/([0-9]+)% packet loss/i", $arr[count($arr) - 3], $lossmatches);
		preg_match("/([0-9]+|[0-9]+\.[0-9]+)\/([0-9]+|[0-9]+\.[0-9]+)\/([0-9]+|[0-9]+\.[0-9]+)\/([0-9]+|[0-9]+\.[0-9]+)\/([0-9]+|[0-9]+\.[0-9]+)\/([0-9]+|[0-9]+\.[0-9]+)\ ms/i", $arr[count($arr) - 2], $delaymatches);
		$resultarr["min"] = floor($delaymatches[1]);
		$resultarr["avg"] = floor($delaymatches[2]);
		$resultarr["max"] = floor($delaymatches[4]);
		$resultarr["loss"] = $lossmatches[1];
	
		return $resultarr;
	}
}